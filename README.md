# DA LEARN - Backend One

## üçÑ Mario Character API

## üõ†Ô∏è Getting Started

### üöÄ Prerequisites
- Postman
- Docker
- Java 21 JDK
- DataGrip (optional)

--------
### üóÑÔ∏è Database Setup
#### Run from your command line to start a PostgreSQL database using Docker:
```
docker run --detach --restart unless-stopped --name da-learn --env POSTGRES_PASSWORD=docker --publish 5432:5432 --volume $HOME/docker/volumes/da-learn/postgres:/var/lib/postgresql/data postgres:16.2
```

#### Once the container is running, you can connect to it using Postgres CLI.
```shell
psql -U postgres -h localhost -d postgres
```

#### Run the following SQL commands to set up the database and user:
```sql
DROP ROLE IF EXISTS pact_service;
CREATE ROLE pact_service WITH PASSWORD 'password' LOGIN CREATEDB;
DROP DATABASE IF EXISTS pact_service;
CREATE DATABASE pact_service;
GRANT ALL ON DATABASE pact_service TO pact_service;
```

#### [OPTIONAL] DataGrip Connection:
- Navigate to the + icon in the top left corner, select ``Data Source`` > ``PostgreSQL`` and fill in the details:
  - User: `postgres`
  - Password: `docker`
- Ensure port is 5432, and press ``Test Connection`` to verify it's working.
- Once satisfied, hit ``OK`` to create the connection.

#### üö® Once finished - stop the postgres container

--------
### üèóÔ∏è Build and Run the Application

#### To build the application, run the following command in your terminal:
```shell
mvn clean install
```

#### If docker is running, you can run the application using:
```shell
mvn spring-boot:run
```
- The app should start and DB should spin up in docker desktop.


### Issues
- If you encounter any issues during the setup of the application, reach out to Andrew Irvine or Ross Gartland on Slack and we'll be more than happy to help!


--------
### üß≠ Tutorial
- Once the application is running locally and database set up, we can dive in!

#### 1Ô∏è‚É£ See Who's in the DB
- Let‚Äôs check if any characters are already saved. On Postman, select the ``Get All Characters`` request and hit send.
- You'll probably get an empty array '[]' back - the kingdom is empty right now!

#### 2Ô∏è‚É£ Add Default Mario Characters
- That's no fun; let's bring some familiar faces into the game. Select the ``Save Default Characters`` request and hit send.
  - If you navigate to the method in ``saveDefaultCharacters()`` in ``CharacterService`` you'll see that it creates a few staple characters.
- Now, if you rerun the request from 1Ô∏è‚É£ you should now see a list of familiar characters appear in the DB table.

#### 3Ô∏è‚É£ Add a New Character (Your Choice!)
- Feeling creative? Add your own Mario-inspired character. Select the ``Save Character`` request, populate the request body and hit send.

##### Example Request Body:
```json
{
  "name": "Waluigi",
  "species": "Human",
  "character_type": "Antagonist",
  "origin_game": "Mario Tennis",
  "created_year": 2000
}
```

#### 4Ô∏è‚É£ Get Single Character
- Let's verify your new character has been added. We could use the endpoint from 1Ô∏è‚É£ but let's try a more specific one.
- Select the ``Get Character`` request and add your new character's name into the ``character_name`` path variable.
- You should get a response with your character's details from 3Ô∏è‚É£ - notice the id field, which is automatically generated by the database; nifty!

#### 5Ô∏è‚É£ Delete a Character
- Okay; it's time to get nasty. Let's remove a character.
  - Hint: Rerun the request from 1Ô∏è‚É£ if you need a reminder of the characters in the DB.
- Select the ``Delete Character`` request, add the name of the character you want to remove in the ``character_name`` path variable and then send.

- You should get a 204 response back indicating the character was successfully deleted.
- Finally, run the request from 1Ô∏è‚É£ to check the character has indeed been deleted.



TODO STILL:
- add validation/null handling 
- refactor any code
- add tests
- tidy up readme